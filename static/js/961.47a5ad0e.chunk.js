"use strict";(self.webpackChunksandbox_gallery_canvas_editor=self.webpackChunksandbox_gallery_canvas_editor||[]).push([[961],{187:(e,n,a)=>{a.d(n,{_:()=>t,o:()=>i});const r="https://picsum.photos";async function t(){var e;let n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;const t=await fetch("".concat(r,"/v2/list?page=").concat(n,"&limit=").concat(a)),i=(await t.json()).map((e=>{let{id:n,author:a,download_url:r}=e;return{id:n,author:a,preview:"https://picsum.photos/id/".concat(n,"/200"),src:r}}));return{hasMore:!(null===(e=t.headers.get("Link"))||void 0===e||!e.includes('rel="next"')),images:i}}async function i(e){const n=await fetch("".concat(r,"/id/").concat(e,"/info")),{author:a,download_url:t,height:i,width:l}=await n.json();return{author:a,src:t,height:i,width:l}}},8961:(e,n,a)=>{a.r(n),a.d(n,{default:()=>v});var r=a(390),t=a(5545),i=a(4514),l=a(9059),s=a(5637),c=a(2155),o=a(5477),d=a(6598),h=a(4417),u=a(82),g=a(6943),x=a(187),m=a(6585);var b=a(2559);const j=(0,r.forwardRef)(((e,n)=>{const a=(0,r.useRef)(null),t=n||a,{src:i,width:l,height:s,blur:c=0,grayscale:o=0}=e;return(0,r.useEffect)((()=>{t&&"current"in t&&t.current&&function(e,n,a,r){const t=e.getContext("2d");if(!t)throw Error("issue with 2d context on canvas");const i=new Image;i.crossOrigin="anonymous",i.src=n,i.onload=()=>{r&&(t.filter=Object.keys(r).map((e=>"".concat(e,"(").concat(r[e],")"))).join(" ")),t.drawImage(i,0,0,a[0],a[1])}}(t.current,i,[l,s],{blur:"".concat(c,"px"),grayscale:"".concat(o,"%")})}),[i,l,s,c,o,t]),(0,b.jsx)(b.Fragment,{children:(0,b.jsx)("canvas",{ref:t,height:s,width:l})})}));var f=a(4508);function p(e){let{blur:n=0,grayscale:a=0,onChangeBlur:t,onChangeGrayscale:i}=e;const[s,c]=(0,r.useState)(n),[d,u]=(0,r.useState)(a);return(0,r.useEffect)((()=>{c(n)}),[n]),(0,r.useEffect)((()=>{u(a)}),[a]),(0,b.jsxs)(h.Z,{direction:"column",gap:1,padding:2,children:[(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(o.Z,{id:"blur-slider",children:"Blur"}),(0,b.jsx)(f.ZP,{"aria-labelledby":"blur-slider",value:s,"aria-label":"Blur level",min:0,max:10,valueLabelDisplay:"auto",onChange:(e,n)=>c(Number(n)),onChangeCommitted:(e,n)=>{c(Number(n)),t(Number(n))}})]}),(0,b.jsxs)(l.Z,{children:[(0,b.jsx)(o.Z,{id:"grayscale-slider",children:"Grayscale (%)"}),(0,b.jsx)(f.ZP,{"aria-labelledby":"grayscale-slider",value:d,"aria-label":"Grayscale level",min:0,max:100,valueLabelDisplay:"auto",onChange:(e,n)=>u(Number(n)),onChangeCommitted:(e,n)=>{u(Number(n)),i(n)}})]})]})}var w=a(8091);function y(e){let{width:n,height:a,onChangeDimensions:t}=e;const[i,l]=(0,r.useState)(a.toString()),[s,c]=(0,r.useState)(n.toString());(0,r.useEffect)((()=>{l(a.toString())}),[a]),(0,r.useEffect)((()=>{c(n.toString())}),[n]);return(0,b.jsxs)(h.Z,{direction:"column",gap:1,padding:1,children:[(0,b.jsx)(w.Z,{required:!0,id:"outlined-required",label:"Width",value:s,onChange:e=>c(e.target.value),name:"width"}),(0,b.jsx)(w.Z,{required:!0,id:"outlined-required",label:"Height",value:i,onChange:e=>l(e.target.value),name:"height"}),(0,b.jsx)(u.Z,{variant:"contained",onClick:()=>{t(Number(s),Number(i))},children:"Apply"})]})}var Z=a(5400);function v(){const e=(0,r.useRef)(null),{imageId:n}=(0,t.UO)(),{isLoading:a,error:f,data:w}=(0,i.useQuery)({queryKey:["gallery",n],queryFn:()=>(0,x.o)(n),keepPreviousData:!0}),{width:v,height:C,blur:k,grayscale:D,onChangeBlur:S,onChangeGrayscale:N,onChangeDimensions:E}=function(){const[e,n]=(0,Z.lr)(),a=Number(e.get("width")),t=Number(e.get("height")),i=Number(e.get("blur"))||0,l=Number(e.get("grayscale"))||0,s=(0,r.useCallback)((e=>{n((n=>(n.set("blur",e.toString()),n)))}),[n]),c=(0,r.useCallback)((e=>{n((n=>(n.set("grayscale",e.toString()),n)))}),[n]),o=(0,r.useCallback)(((e,a)=>{n((n=>(n.set("width",e.toString()),n.set("height",a.toString()),n)))}),[n]);return{height:t,width:a,blur:i,grayscale:l,onChangeDimensions:o,onChangeBlur:s,onChangeGrayscale:c}}();if(a)return(0,b.jsx)(m.g,{});if(!w||f)return(0,b.jsx)(b.Fragment,{children:"An error has occurred"});return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{ref:e,src:w.src,height:C||w.height,width:v||w.width,blur:k,grayscale:D}),(0,b.jsxs)(l.Z,{position:"fixed",top:50,right:50,bgcolor:"white",sx:{opacity:.8},children:[(0,b.jsxs)(s.Z,{children:[(0,b.jsx)(c.Z,{expandIcon:(0,b.jsx)(g.Z,{}),"aria-controls":"panel1a-content",id:"panel1a-header",children:(0,b.jsx)(o.Z,{children:"Dimensions"})}),(0,b.jsx)(d.Z,{children:(0,b.jsx)(y,{height:C||w.height,width:v||w.width,onChangeDimensions:E})})]}),(0,b.jsxs)(s.Z,{children:[(0,b.jsx)(c.Z,{expandIcon:(0,b.jsx)(g.Z,{}),"aria-controls":"panel2a-content",id:"panel2a-header",children:(0,b.jsx)(o.Z,{children:"Filters"})}),(0,b.jsx)(d.Z,{children:(0,b.jsx)(p,{blur:k,grayscale:D,onChangeBlur:S,onChangeGrayscale:N})})]}),(0,b.jsxs)(s.Z,{children:[(0,b.jsx)(c.Z,{expandIcon:(0,b.jsx)(g.Z,{}),"aria-controls":"panel3a-content",id:"panel3a-header",children:(0,b.jsx)(o.Z,{children:"Download"})}),(0,b.jsx)(d.Z,{children:(0,b.jsxs)(h.Z,{children:[(0,b.jsx)(u.Z,{variant:"contained",onClick:()=>{e.current&&function(e,n){const a=e.toDataURL(),r=document.createElement("a");r.download=n,r.href=a,r.click()}(e.current,"edited.png")},children:"Download Edited Image"}),(0,b.jsx)(u.Z,{onClick:()=>{!async function(e,n){const a=await fetch(e).then((e=>e.blob())),r=URL.createObjectURL(a);var t=document.createElement("a");t.href=r,t.download=n,t.click()}(w.src,"original.png")},children:"Download Original Image"})]})})]})]})]})}}}]);
//# sourceMappingURL=961.47a5ad0e.chunk.js.map